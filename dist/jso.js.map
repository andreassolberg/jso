{"version":3,"sources":["webpack://jso/webpack/universalModuleDefinition","webpack://jso/webpack/bootstrap","webpack://jso/./src/utils.js","webpack://jso/./src/store.js","webpack://jso/./src/Loaders/BasicLoader.js","webpack://jso/./src/Loaders/HTTPRedirect.js","webpack://jso/./src/Loaders/IFramePassive.js","webpack://jso/./src/Loaders/Popup.js","webpack://jso/./src/errors/Error.js","webpack://jso/./src/errors/ExpiredTokenError.js","webpack://jso/./src/HTTP/Fetcher.js","webpack://jso/./src/HTTP/FetcherJQuery.js","webpack://jso/./src/errors/OAuthResponseError.js","webpack://jso/./src/Config.js","webpack://jso/./src/EventEmitter.js","webpack://jso/./src/JSO.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","utils","Math","round","Date","getTime","replace","random","toString","url","indexOf","parseQueryString","substring","qs","e","a","decodeURIComponent","q","urlParams","exec","scopes","uniqueList","join","items","uniqueItems","resultItems","length","push","msg","console","log","debug","args","Array","slice","arguments","unshift","apply","params","k","res","encodeURIComponent","firstSeparator","Store","_classCallCheck","this","state","obj","localStorage","setItem","JSON","stringify","parse","getItem","removeItem","token","scope","tokens","j","usethis","result","now","epoch","expires","hasScope","provider","location","href","getTokens","filterTokens","saveTokens","BasicLoader","BasicLoader_classCallCheck","HTTPRedirect","_this","Promise","resolve","reject","IFramePassive","IFramePassive_classCallCheck","IFramePassive_possibleConstructorReturn","IFramePassive_getPrototypeOf","timeout","callback","isCompleted","id","uuid","eventMethod","addEventListener","iframe","document","createElement","setAttribute","contentWindow","hash","encodedHash","search","_completed","_failed","Error","err","_this2","errorCallback","getElementsByTagName","appendChild","setTimeout","element","getElementById","parentNode","removeChild","_cleanup","response","Popup","popupCompleted","newwindow","open","focus","props","Error_classCallCheck","ExpiredTokenError","Fetcher","jso","Fetcher_classCallCheck","opts","fetch","then","status","reccur","getTokenOpts","fetchOpts","assign","getToken","error","headers","Authorization","access_token","_fetch","wipeTokens","FetcherJQuery","jquery","FetcherJQuery_classCallCheck","done","fail","jqXHR","textStatus","errorThrown","parseInt","ajax","OAuthResponseError","error_description","Config","Config_classCallCheck","config","pointer","splittedKeys","split","defaultValue","isRequired","undefined","EventEmitter","type","_callbacks","require","default_config","lifetime","JSO","JSO_classCallCheck","JSO_possibleConstructorReturn","JSO_getPrototypeOf","configure","providerID","getProviderID","Loader","store","callbacks","getValue","newstore","loader","client_id","atoken","getState","processReceivedToken","received","expires_in","has","saveToken","restoreHash","emit","Headers","append","btoa","tokenRequest","grant_type","code","redirect_uri","method","body","encodeQS","httpResponse","json","tokenResponse","data","JSO_typeof","getResponseFromURL","processTokenResponse","processAuthorizationCodeResponse","processErrorResponse","request","_this3","scopesRequire","_getRequiredScopes","allowredir","_authorize","authurl","_this4","openid","authorization","response_type","_getRequestScopes","includes","scopeList","nonce","encodeURL","saveState","gotoAuthorizeURL","execute"],"mappings":"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","file":"jso.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jso\"] = factory();\n\telse\n\t\troot[\"jso\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","\nlet utils = {}\n\n/*\n * Returns epoch, seconds since 1970.\n * Used for calculation of expire times.\n */\nutils.epoch = function() {\n\treturn Math.round(new Date().getTime()/1000.0)\n}\n\nutils.debug = false\n\n/*\n * Returns a random string used for state\n */\nutils.uuid = function() {\n\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t\tvar r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8)\n\t    return v.toString(16)\n\t})\n}\n\n/*\n * Takes a full url as input and expect it to have an encoded response\n * object as eigther a query string or an encoded fragment.\n * Returns the decoded object, or throws an error if no query string or fragment.\n */\nutils.getResponseFromURL = function (url) {\n  if (url.indexOf('#') !== -1) {\n    return utils.parseQueryString(url.substring(url.indexOf('#')+1))\n  } else if (url.indexOf('?') !== -1) {\n    return utils.parseQueryString(url.substring(url.indexOf('?')+1))\n  }\n  return {}\n}\n\nutils.parseQueryString = function (qs) {\n\tvar e,\n\t\ta = /\\+/g,  // Regex for replacing addition symbol with a space\n\t\tr = /([^&;=]+)=?([^&;]*)/g,\n\t\td = function (s) { return decodeURIComponent(s.replace(a, \" \")) },\n\t\tq = qs,\n\t\turlParams = {}\n\n\t/* jshint ignore:start */\n\twhile (e = r.exec(q)) {\n\t   urlParams[d(e[1])] = d(e[2])\n\t};\n\t/* jshint ignore:end */\n\n\treturn urlParams\n}\n\n\n\n\n\n/**\n * Utility: scopeList(scopes )\n * Takes a list of scopes that might be overlapping, and removed duplicates,\n * then concatenates the list by spaces and returns a string.\n *\n * @param  {[type]} scopes [description]\n * @return {[type]}        [description]\n */\nutils.scopeList = function(scopes) {\n\treturn utils.uniqueList(scopes).join(' ')\n}\n\n\nutils.uniqueList = function(items) {\n\tvar uniqueItems = {}\n\tvar resultItems = []\n\tfor(var i = 0; i < items.length; i++) {\n\t\tuniqueItems[items[i]] = 1\n\t}\n\tfor(var key in uniqueItems) {\n\t\tif (uniqueItems.hasOwnProperty(key)) {\n\t\t\tresultItems.push(key)\n\t\t}\n\t}\n\treturn resultItems\n}\n\n\n\n/**\n * A log wrapper, that only logs if logging is turned on in the config\n * @param  {string} msg Log message\n */\nutils.log = function(msg) {\n\tif (!console) return\n\tif (!console.log) return\n  if (!utils.debug) return\n\n  let args = Array.prototype.slice.call(arguments)\n  args.unshift('[JSO]')\n\tconsole.log.apply(console, args)\n\n}\n\nutils.encodeQS = function(params) {\n  let res = ''\n\tvar k, i = 0\n\tfor(k in params) {\n\t\tres += (i++ === 0 ? '' : '&') + encodeURIComponent(k) + '=' + encodeURIComponent(params[k])\n\t}\n\treturn res\n}\n\n/*\n * Takes an URL as input and a params object.\n * Each property in the params is added to the url as query string parameters\n */\nutils.encodeURL = function(url, params) {\n\tvar res = url\n\tvar k, i = 0\n\tvar firstSeparator = (url.indexOf(\"?\") === -1) ? '?' : '&'\n\tfor(k in params) {\n\t\tres += (i++ === 0 ? firstSeparator : '&') + encodeURIComponent(k) + '=' + encodeURIComponent(params[k])\n\t}\n\treturn res\n}\n\n\nexport default utils\n","import utils from './utils'\n\nclass Store {\n\n\tconstructor() {\n\t}\n\n\t/*\n\t\tsaveState stores an object with an Identifier.\n\t\tTODO: Ensure that both localstorage and JSON encoding has fallbacks for ancient browsers.\n\t\tIn the state object, we put the request object, plus these parameters:\n\t\t  * restoreHash\n\t\t  * providerID\n\t\t  * scopes\n\n\t */\n\tsaveState(state, obj) {\n\t\tlocalStorage.setItem(\"state-\" + state, JSON.stringify(obj))\n\t}\n\n\t/**\n\t * getStage()  returns the state object, but also removes it.\n\t * @type {Object}\n\t */\n\tgetState(state) {\n\t\t// log(\"getState (\" + state+ \")\");\n\t\tvar obj = JSON.parse(localStorage.getItem(\"state-\" + state))\n\t\tlocalStorage.removeItem(\"state-\" + state)\n\t\treturn obj\n\t}\n\n\n\t/*\n\t * Checks if a token, has includes a specific scope.\n\t * If token has no scope at all, false is returned.\n\t */\n\thasScope(token, scope) {\n\t\tvar i\n\t\tif (!token.scopes) return false\n\t\tfor(i = 0; i < token.scopes.length; i++) {\n\t\t\tif (token.scopes[i] === scope) return true\n\t\t}\n\t\treturn false\n\t}\n\n\t/*\n\t * Takes an array of tokens, and removes the ones that\n\t * are expired, and the ones that do not meet a scopes requirement.\n\t */\n\tfilterTokens(tokens, scopes) {\n\t\tvar i, j,\n\t\t\tresult = [],\n\t\t\tnow = utils.epoch(),\n\t\t\tusethis\n\n\t\tif (!scopes) scopes = []\n\n\t\tfor(i = 0; i < tokens.length; i++) {\n\t\t\tusethis = true\n\n\t\t\t// Filter out expired tokens. Tokens that is expired in 1 second from now.\n\t\t\tif (tokens[i].expires && tokens[i].expires < (now+1)) usethis = false\n\n\t\t\t// Filter out this token if not all scope requirements are met\n\t\t\tfor(j = 0; j < scopes.length; j++) {\n\t\t\t\tif (!this.hasScope(tokens[i], scopes[j])) usethis = false\n\t\t\t}\n\n\t\t\tif (usethis) result.push(tokens[i])\n\t\t}\n\t\treturn result\n\t}\n\n\n\t/*\n\t * saveTokens() stores a list of tokens for a provider.\n\n\t\tUsually the tokens stored are a plain Access token plus:\n\t\t  * expires : time that the token expires\n\t\t  * providerID: the provider of the access token?\n\t\t  * scopes: an array with the scopes (not string)\n\t */\n\tsaveTokens(provider, tokens) {\n\t\t// log(\"Save Tokens (\" + provider+ \")\");\n\t\tlocalStorage.setItem(\"tokens-\" + provider, JSON.stringify(tokens))\n\t}\n\n\tgetTokens(provider) {\n\t\t// log(\"Get Tokens (\" + provider+ \")\");\n\t\tvar tokens = JSON.parse(localStorage.getItem(\"tokens-\" + provider))\n\t\tif (!tokens) tokens = []\n\n\t\tutils.log(\"Token found when loooking up provider \" + provider + \" in store \" + window.location.href, tokens)\n\t\treturn tokens\n\t}\n\n\twipeTokens(provider) {\n\t\tlocalStorage.removeItem(\"tokens-\" + provider)\n\t}\n\n\t/*\n\t * Save a single token for a provider.\n\t * This also cleans up expired tokens for the same provider.\n\t */\n\tsaveToken(provider, token) {\n\t\tvar tokens = this.getTokens(provider)\n\t\ttokens = this.filterTokens(tokens)\n\t\ttokens.push(token)\n\t\tthis.saveTokens(provider, tokens)\n\t}\n\n\t/*\n\t * Get a token if exists for a provider with a set of scopes.\n\t * The scopes parameter is OPTIONAL.\n\t */\n\tgetToken(provider, scopes) {\n\t\tvar tokens = this.getTokens(provider)\n\t\ttokens = this.filterTokens(tokens, scopes)\n\t\tif (tokens.length < 1) return null\n\t\treturn tokens[0]\n\t};\n\n}\n\nvar s = new Store()\n\nexport default s\n","export default class BasicLoader {\n\tconstructor(url) {\n\t\tconsole.log(\"Initializing a loader with url \" + url)\n\t\tthis.url = url\n\t}\n\texecute() {\n\n\t}\n}\n","import BasicLoader from './BasicLoader'\nimport utils from '../utils'\n\nexport default class HTTPRedirect extends BasicLoader {\n\texecute() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\twindow.location = this.url\n\t\t})\n\t}\n}\n","import BasicLoader from './BasicLoader'\nimport utils from '../utils'\n\nexport default class IFramePassive extends BasicLoader {\n\n\tconstructor(url) {\n\t\tsuper(url)\n\n\t\tthis.timeout = 5000\n\t\tthis.callback = null\n\t\tthis.isCompleted = false\n    this.id = 'jso_passive_iframe_' + utils.uuid()\n\n    // Create IE + others compatible event handler\n    var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\"\n    var eventer = window[eventMethod]\n    var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\"\n\n    this.iframe = document.createElement('iframe')\n    this.iframe.setAttribute('id', this.id)\n    this.iframe.setAttribute('src', url)\n\n    this.iframe.addEventListener('load', (e) => {\n\n      let object = null\n      try {\n        if (this.iframe.contentWindow.location.hash) {\n          let encodedHash = this.iframe.contentWindow.location.hash.substring(1)\n          object = utils.parseQueryString(encodedHash)\n        } else if (this.iframe.contentWindow.location.search) {\n          let encodedHash = this.iframe.contentWindow.location.search.substring(1)\n          object = utils.parseQueryString(encodedHash)\n        }\n\n        if (object !== null) {\n          this._completed(object)\n        } else {\n          this._failed(new Error(\"Failed to obtain response value from iframe\"))\n        }\n      } catch(err) {\n        // Most likely not able to access the content window because of same-origin policy.\n        //\n        // Ignore this error, as this is likely to happen during the SSO redirect loop, but the load\n        // event may be triggered multiple times, so it is not neccessary a problem that the first is not\n        // accessible.\n      }\n\n    })\n\n\t}\n\n\texecute() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.callback = resolve\n      this.errorCallback = reject\n      document.getElementsByTagName('body')[0].appendChild(this.iframe)\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._failed(new Error(\"Loading iframe timed out\"))\n\t\t\t}, this.timeout)\n\t\t})\n\t}\n\n\n\t_cleanup() {\n    let element = document.getElementById(this.id)\n    element.parentNode.removeChild(element)\n\t}\n\n  _failed(err) {\n    if (!this.isCompleted) {\n\t\t\tif (this.errorCallback && typeof this.errorCallback === 'function') {\n\t\t\t\tthis.errorCallback(err)\n\t\t\t}\n\t\t\tthis.isCompleted = true\n\t\t\tthis._cleanup()\n\t\t}\n  }\n\n\t_completed(response) {\n\t\tif (!this.isCompleted) {\n\t\t\tif (this.callback && typeof this.callback === 'function') {\n\t\t\t\tthis.callback(response)\n\t\t\t}\n\t\t\tthis.isCompleted = true\n\t\t\tthis._cleanup()\n\t\t}\n\t}\n}\n","import BasicLoader from './BasicLoader'\n\nexport default class Popup extends BasicLoader {\n\n  execute() {\n\n\t\t/*\n\t\t* In the popup's scripts, running on <http://example.org>:\n\t\t*/\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t// window.addEventListener(\"jso_message\", function(event) {\n\t\t\t// \tconsole.log(\"Sent a message to event.origin \" + event.origin + \" and got the following in response:\")\n\t\t\t// \tconsole.log(\"<em>\", event.data, \"</em>\")\n\t    // \tvar url = newwindow.location.href\n\t    // \t// console.error(\"Popup location is \", url, newwindow.location)\n      //   resolve(url)\n\t\t\t// })\n\n  \t\twindow.popupCompleted = function() {\n\t    \tvar url = newwindow.location.href\n        resolve(url)\n\t\t\t}\n\n\t\t\tvar newwindow = window.open(this.url, 'jso-popup-auth', 'height=600,width=800')\n      if (newwindow === null) {\n        throw new Error(\"Error loading popup window\")\n      }\n\t\t\tif (window.focus) {\n\t\t\t\tnewwindow.focus()\n\t\t\t}\n\n\t\t})\n\t}\n}\n","\nexport default class Error {\n\tconstructor(props) {\n\t\tfor(var key in props) {\n\t\t\tthis[key] = props[key];\n\t\t}\n\t}\n\n\tset(key, value) {\n\t\tthis[key] = value;\n\t\treturn this;\n\t}\n}","import Error from './Error';\n\nexport default class ExpiredTokenError extends Error {\n\n}","\nimport ExpiredTokenError from '../errors/ExpiredTokenError'\n\nexport default class Fetcher {\n\tconstructor(jso) {\n    this.jso = jso\n\t}\n\n  _fetch(url, opts) {\n    return fetch(url, opts)\n      .then((response) => {\n        if (response.status === 401) {\n          throw new ExpiredTokenError()\n        }\n        return response\n      })\n  }\n\n\tfetch(url, opts, reccur) {\n    reccur = reccur ? reccur : 0\n    if (reccur > 2) {\n      throw new Error(\"Reccursion error. Expired tokens deleted and tried again multiple times.\")\n    }\n    let getTokenOpts = {}\n    let fetchOpts = {\n      'mode': 'cors'\n    }\n    if (opts) {\n      fetchOpts = opts\n      Object.assign(fetchOpts, opts)\n    }\n    if (opts && opts.jso) {\n      Object.assign(getTokenOpts, opts.jso)\n    }\n\n    return this.jso.getToken(getTokenOpts)\n      .catch((err) => {\n        console.error(\"Error fetching token to use \", err)\n      })\n      .then((token) => {\n      \t// console.log(\"I got the token: \", token.access_token)\n\n        if (!fetchOpts.headers) {\n          fetchOpts.headers = {}\n        }\n        fetchOpts.headers.Authorization = 'Bearer ' + token.access_token\n        return this._fetch(url, fetchOpts)\n          .catch((err) => {\n            if (err instanceof ExpiredTokenError) {\n              console.error(\"Token was expired. Deleting all tokens for this provider and get a new one\", err)\n              this.jso.wipeTokens()\n              return this.fetch(url, opts, reccur+1)\n            }\n          })\n\n      })\n\t}\n\n\n\n}\n","import ExpiredTokenError from '../errors/ExpiredTokenError'\n\nexport default class FetcherJQuery {\n\tconstructor(jso, jquery) {\n    this.jso = jso\n    this.jquery = jquery\n\t}\n\n  _fetch(url, opts) {\n\n    return new Promise((resolve, reject) => {\n\n      opts.done = resolve\n      opts.fail = (jqXHR, textStatus, errorThrown) => {\n        let status = parseInt(textStatus, 10)\n        if (status === 401) {\n          this.jso.wipeTokens()\n          return reject(new ExpiredTokenError())\n        }\n        return reject(errorThrown)\n      }\n      return this.jquery.ajax(url, opts)\n\n    })\n\n  }\n\n\tfetch(url, opts, reccur) {\n    reccur = reccur ? reccur : 0\n    if (reccur > 2) {\n      throw new Error(\"Reccursion error. Expired tokens deleted and tried again multiple times.\")\n    }\n    let getTokenOpts = {}\n    let fetchOpts = {\n      'mode': 'cors'\n    }\n    if (opts) {\n      fetchOpts = opts\n      Object.assign(fetchOpts, opts)\n    }\n    if (opts && opts.jso) {\n      Object.assign(getTokenOpts, opts.jso)\n    }\n\n    return this.jso.getToken(getTokenOpts)\n      .catch((err) => {\n        console.error(\"Error fetching token to use \", err)\n      })\n      .then((token) => {\n      \t// console.log(\"I got the token: \", token.access_token)\n\n        if (!fetchOpts.headers) {\n          fetchOpts.headers = {}\n        }\n        fetchOpts.headers.Authorization = 'Bearer ' + token.access_token\n        return this._fetch(url, fetchOpts)\n          .catch((err) => {\n            if (err instanceof ExpiredTokenError) {\n              console.error(\"Token was expired. Deleting all tokens for this provider and get a new one\", err)\n              this.jso.wipeTokens()\n              return this.fetch(url, opts, reccur+1)\n            }\n          })\n\n      })\n\t}\n\n\n\n}\n","import Error from './Error'\n\nexport default class OAuthResponseError extends Error {\n\n  toString() {\n    let header = this.error || 'unknown'\n    let descr = this.error_description || 'unknown'\n    return 'OAuthResponseError: [' + header + ']: ' + descr\n  }\n}\n","export default class Config {\n\n\tconstructor() {\n    this.config = {}\n\t\tfor(var i = 0; i < arguments.length; i++) {\n      Object.assign(this.config, arguments[i])\n\t\t}\n\t}\n\n\thas(key) {\n\t\tvar pointer = this.config\n\t\tvar splittedKeys = key.split('.')\n\t\tvar i = 0\n\t\tfor(i = 0; i < splittedKeys.length; i++) {\n\t\t\tif (pointer.hasOwnProperty(splittedKeys[i])) {\n\t\t\t\tpointer = pointer[splittedKeys[i]]\n\t\t\t} else {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\t\treturn true\n\t}\n\n\tgetValue(key, defaultValue, isRequired) {\n\t\tvar isRequired = isRequired || false\n\t\tvar pointer = this.config\n\t\tvar splittedKeys = key.split('.')\n\t\tvar i = 0\n\t\tfor(i = 0; i < splittedKeys.length; i++) {\n\n\t\t\tif (pointer.hasOwnProperty(splittedKeys[i])) {\n\t\t\t\t// console.log(\"POINTING TO \" + splittedKeys[i]);\n\t\t\t\tpointer = pointer[splittedKeys[i]]\n\t\t\t} else {\n\t\t\t\tpointer = undefined\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tif (typeof pointer === 'undefined') {\n\t\t\tif (isRequired) {\n\t\t\t\tthrow new Error(\"Configuration option [\" + splittedKeys[i] + \"] required but not provided.\")\n\t\t\t}\n\t\t\treturn defaultValue\n\t\t}\n\t\treturn pointer\n\t}\n}\n","export default class EventEmitter {\n\n  on(type, callback) {\n    if (!this._callbacks) {\n      this._callbacks = {}\n    }\n    if (!this._callbacks[type]) {\n      this._callbacks[type] = []\n    }\n\n    this._callbacks[type].push(callback)\n  }\n\n  emit(type) {\n    if (!this._callbacks) {\n      this._callbacks = {}\n    }\n    if (!this._callbacks[type]) {\n      this._callbacks[type] = []\n    }\n\n    var args = Array.prototype.slice.call(arguments, 1)\n    for(var i = 0; i < this._callbacks[type].length; i++) {\n      this._callbacks[type][i].apply(this, args)\n    }\n  }\n}\n","/**\n * JSO - Javascript OAuth Library\n * \tVersion 4.0\n *  UNINETT AS - http://uninett.no\n *  Author: Andreas Åkre Solberg <andreas.solberg@uninett.no>\n *  Licence: Simplified BSD Licence\n *\n *  Documentation available at: https://github.com/andreassolberg/jso\n */\n\nimport store from \"./store\";\nimport utils from \"./utils\";\n\n// Work in progress\n// import Authentication from './Authentication/Authentication'\n\nimport BasicLoader from \"./Loaders/BasicLoader\";\nimport HTTPRedirect from \"./Loaders/HTTPRedirect\";\nimport IFramePassive from \"./Loaders/IFramePassive\";\nimport Popup from \"./Loaders/Popup\";\n\nimport Fetcher from \"./HTTP/Fetcher\";\nimport FetcherJQuery from \"./HTTP/FetcherJQuery\";\n\n// import ExpiredTokenError from './errors/ExpiredTokenError'\n// import HTTPError from './errors/HTTPError'\nimport OAuthResponseError from \"./errors/OAuthResponseError\";\n\nimport Config from \"./Config\";\nimport EventEmitter from \"./EventEmitter\";\n\nconst package_json = require(\"../package.json\");\n\nconst default_config = {\n  lifetime: 3600\n};\n\nclass JSO extends EventEmitter {\n  constructor(config) {\n    super();\n    this.configure(config);\n    this.providerID = this.getProviderID();\n    this.Loader = HTTPRedirect;\n    this.store = store;\n    this.callbacks = {};\n\n    if (this.config.getValue(\"debug\", false)) {\n      utils.debug = true;\n    }\n  }\n\n  configure(config) {\n    this.config = new Config(default_config, config);\n  }\n\n  // Experimental, nothing but default store exists yet. Not documented.\n  setStore(newstore) {\n    this.store = newstore;\n  }\n\n  setLoader(loader) {\n    if (typeof loader === \"function\") {\n      this.Loader = loader;\n    } else {\n      throw new Error(\"loader MUST be an instance of the JSO BasicLoader\");\n    }\n  }\n\n  /**\n   * We need to get an identifier to represent this OAuth provider.\n   * The JSO construction option providerID is preferred, if not provided\n   * we construct a concatentaion of authorization url and client_id.\n   * @return {[type]} [description]\n   */\n  getProviderID() {\n    var c = this.config.getValue(\"providerID\", null);\n    if (c !== null) {\n      return c;\n    }\n\n    var client_id = this.config.getValue(\"client_id\", null, true);\n    var authorization = this.config.getValue(\"authorization\", null, true);\n\n    return authorization + \"|\" + client_id;\n  }\n\n  /**\n   * If the callback has already successfully parsed a token response, call this.\n   * @return {[type]} [description]\n   */\n  processTokenResponse(atoken) {\n    let state;\n    if (atoken.state) {\n      state = this.store.getState(atoken.state);\n    } else {\n      throw new Error(\"Could not get state from storage.\");\n    }\n\n    if (!state) {\n      throw new Error(\"Could not retrieve state\");\n    }\n    if (!state.providerID) {\n      throw new Error(\"Could not get providerid from state\");\n    }\n    utils.log(\"processTokenResponse \", atoken, \"\");\n    return this.processReceivedToken(atoken, state);\n  }\n\n  processReceivedToken(atoken, state) {\n    /*\n     * Decide when this token should expire.\n     * Priority fallback:\n     * 1. Access token expires_in\n     * 2. Life time in config (may be false = permanent...)\n     * 3. Specific permanent scope.\n     * 4. Default library lifetime:\n     */\n    let now = utils.epoch();\n    atoken.received = now;\n    if (atoken.expires_in) {\n      atoken.expires = now + parseInt(atoken.expires_in, 10);\n      atoken.expires_in = parseInt(atoken.expires_in, 10);\n    } else if (this.config.getValue(\"default_lifetime\", null) === false) {\n      atoken.expires = null;\n    } else if (this.config.has(\"permanent_scope\")) {\n      if (\n        !this.store.hasScope(atoken, this.config.getValue(\"permanent_scope\"))\n      ) {\n        atoken.expires = null;\n      }\n    } else if (this.config.has(\"default_lifetime\")) {\n      atoken.expires = now + this.config.getValue(\"default_lifetime\");\n    } else {\n      atoken.expires = now + 3600;\n    }\n\n    /*\n     * Handle scopes for this token\n     */\n    if (atoken.scope) {\n      atoken.scopes = atoken.scope.split(\" \");\n      delete atoken.scope;\n    } else if (state.scopes) {\n      atoken.scopes = state.scopes;\n    } else {\n      atoken.scopes = [];\n    }\n\n    utils.log(\"processTokenResponse completed \", atoken, \"\");\n\n    this.store.saveToken(state.providerID, atoken);\n\n    if (state.restoreHash) {\n      window.location.hash = state.restoreHash;\n    } else {\n      window.location.hash = \"\";\n    }\n    return atoken;\n  }\n\n  // Experimental support for authorization code to be added\n  processAuthorizationCodeResponse(object) {\n    console.log(this);\n    this.emit(\"authorizationCode\", object);\n\n    let state;\n    if (object.state) {\n      state = this.store.getState(object.state);\n      if (state === null) {\n        throw new Error(\"Could not find retrieve state object.\");\n      }\n    } else {\n      throw new Error(\"Could not find state paramter from callback.\");\n    }\n    console.log(\"state\", state);\n\n    if (!this.config.has(\"token\")) {\n      utils.log(\n        \"Received an authorization code. Will not process it as the config option [token] endpoint is not set. If you would like to process the code yourself, please subscribe to the [authorizationCode] event\"\n      );\n      return;\n    }\n    if (!this.config.has(\"client_secret\")) {\n      throw new Error(\"Configuration missing [client_secret]\");\n    }\n    let headers = new Headers();\n    headers.append(\n      \"Authorization\",\n      \"Basic \" +\n        btoa(\n          this.config.getValue(\"client_id\") +\n            \":\" +\n            this.config.getValue(\"client_secret\")\n        )\n    );\n    headers.append(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded;charset=UTF-8\"\n    );\n\n    let tokenRequest = {\n      grant_type: \"authorization_code\",\n      code: object.code\n    };\n\n    if (state.hasOwnProperty(\"redirect_uri\")) {\n      tokenRequest.redirect_uri = state.redirect_uri;\n    }\n\n    let opts = {\n      mode: \"cors\",\n      headers: headers,\n      method: \"POST\", // or 'PUT'\n      body: utils.encodeQS(tokenRequest) // data can be `string` or {object}!\n    };\n    return fetch(this.config.getValue(\"token\"), opts)\n      .then(httpResponse => {\n        return httpResponse.json();\n      })\n      .then(tokenResponse => {\n        // let tokenResponse = httpResponse.json()\n        utils.log(\"Received response on token endpoint \", tokenResponse, \"\");\n        return this.processReceivedToken(tokenResponse, state);\n      });\n\n    // throw new Exception(\"Implementation of authorization code flow is not yet implemented. Instead use the implicit grant flow\")\n  }\n\n  processErrorResponse(err) {\n    var state;\n    if (err.state) {\n      state = this.store.getState(err.state);\n    } else {\n      throw new Error(\n        \"Could not get [state] and no default providerid is provided.\"\n      );\n    }\n\n    if (!state) {\n      throw new Error(\"Could not retrieve state\");\n    }\n    if (!state.providerID) {\n      throw new Error(\"Could not get providerid from state\");\n    }\n\n    if (state.restoreHash) {\n      window.location.hash = state.restoreHash;\n    } else {\n      window.location.hash = \"\";\n    }\n    return new OAuthResponseError(err);\n  }\n\n  /**\n   * Check if the hash contains an access token.\n   * And if it do, extract the state, compare with\n   * config, and store the access token for later use.\n   *\n   * The url parameter is optional. Used with phonegap and\n   * childbrowser when the jso context is not receiving the response,\n   * instead the response is received on a child browser.\n   */\n  callback(data) {\n    let response = null;\n    if (typeof data === \"object\") {\n      response = data;\n    } else if (typeof data === \"string\") {\n      response = utils.getResponseFromURL(data);\n    } else if (typeof data === \"undefined\") {\n      response = utils.getResponseFromURL(window.location.href);\n    } else {\n      // no response provided.\n      return;\n    }\n\n    utils.log(\"Receving response in callback\", response);\n\n    if (response.hasOwnProperty(\"access_token\")) {\n      return this.processTokenResponse(response);\n\n      // Implementation of authorization code flow is in beta.\n    } else if (response.hasOwnProperty(\"code\")) {\n      return this.processAuthorizationCodeResponse(response);\n    } else if (response.hasOwnProperty(\"error\")) {\n      throw this.processErrorResponse(response);\n    }\n  }\n\n  dump() {\n    var tokens = this.store.getTokens(this.providerID);\n    var x = {\n      providerID: this.providerID,\n      tokens: tokens,\n      config: this.config\n    };\n    return x;\n  }\n\n  _getRequestScopes(opts) {\n    var scopes = [],\n      i;\n    /*\n     * Calculate which scopes to request, based upon provider config and request config.\n     */\n    if (this.config.has(\"scopes.request\")) {\n      let s = this.config.getValue(\"scopes.request\");\n      for (i = 0; i < s.length; i++) {\n        scopes.push(s[i]);\n      }\n    }\n    if (opts && opts.scopes && opts.scopes.request) {\n      for (i = 0; i < opts.scopes.request.length; i++) {\n        scopes.push(opts.scopes.request[i]);\n      }\n    }\n    return utils.uniqueList(scopes);\n  }\n\n  _getRequiredScopes(opts) {\n    var scopes = [],\n      i;\n    /*\n     * Calculate which scopes to request, based upon provider config and request config.\n     */\n    if (this.config.has(\"scopes.require\")) {\n      let s = this.config.getValue(\"scopes.require\");\n      for (i = 0; i < s.length; i++) {\n        scopes.push(s[i]);\n      }\n    }\n    if (opts && opts.scopes && opts.scopes.require) {\n      for (i = 0; i < opts.scopes.require.length; i++) {\n        scopes.push(opts.scopes.require[i]);\n      }\n    }\n    return utils.uniqueList(scopes);\n  }\n\n  /**\n   * If getToken is called with allowia = false, and a token is not cached, it will return null.\n   * The scopes.required is used to pick from existing tokens.\n   *\n   * @param  {[type]} opts [description]\n   * @return {[type]}      [description]\n   */\n  getToken(opts) {\n    opts = opts || {};\n\n    return new Promise((resolve, reject) => {\n      let scopesRequire = this._getRequiredScopes(opts);\n      let token = this.store.getToken(this.providerID, scopesRequire);\n\n      if (token) {\n        return resolve(token);\n      } else {\n        if (opts.hasOwnProperty(\"allowredir\") && !opts.allowredir) {\n          throw new Error(\n            \"Cannot obtain a token, when not allowed to redirect...\"\n          );\n        } else {\n          resolve(this._authorize(opts));\n        }\n      }\n    });\n  }\n\n  checkToken(opts) {\n    // var scopesRequest  = this._getRequestScopes(opts)\n\n    var scopesRequire = this._getRequiredScopes(opts);\n    return this.store.getToken(this.providerID, scopesRequire);\n  }\n\n  /**\n   * Send authorization request.\n   *\n   * @param  {[type]} opts These options matches the ones sent in the \"oauth\" property of the ajax settings in the request.\n   * @return {[type]}      [description]\n   */\n  _authorize(opts) {\n    var request, authurl, scopes;\n\n    return Promise.resolve().then(() => {\n      let authorization = this.config.getValue(\"authorization\", null, true);\n      let client_id = this.config.getValue(\"client_id\", null, true);\n      let openid = false;\n\n      if (opts.hasOwnProperty(\"allowia\") || this.config.has(\"allowia\")) {\n        throw new Error(\n          'The allowia option was removed in JSO 4.1.0. Instead use {request: {prompt: \"none\"}}'\n        );\n      }\n\n      utils.log(\n        \"About to send an authorization request to this endpoint\",\n        authorization\n      );\n      utils.log(\"Options\", opts);\n\n      request = {};\n\n      if (this.config.has(\"request\")) {\n        let r = this.config.getValue(\"request\");\n        request = Object.assign(request, r);\n      }\n      if (opts.hasOwnProperty(\"request\")) {\n        request = Object.assign(request, opts.request);\n      }\n\n      request.response_type =\n        opts.response_type ||\n        this.config.getValue(\"response_type\", \"id_token token\");\n      request.state = utils.uuid();\n\n      if (this.config.has(\"redirect_uri\")) {\n        request.redirect_uri = this.config.getValue(\"redirect_uri\", \"\");\n      }\n      if (opts.redirect_uri) {\n        request.redirect_uri = opts.redirect_uri;\n      }\n\n      request.client_id = client_id;\n\n      /*\n       * Calculate which scopes to request, based upon provider config and request config.\n       */\n      scopes = this._getRequestScopes(opts);\n      openid = scopes.includes(\"openid\");\n      if (scopes.length > 0) {\n        request.scope = utils.scopeList(scopes);\n      }\n      utils.log(\n        \"Running in mode: \" + (openid ? \"OpenID Connect mode\" : \"OAuth mode\")\n      );\n\n      if (openid && !request.hasOwnProperty(\"redirect_uri\")) {\n        throw new Error(\n          \"An OpenID Request requires a redirect_uri to be set. Please add to configuration. A redirect_uri is not required for plain OAuth\"\n        );\n      }\n\n      if (openid) {\n        request.nonce = utils.uuid();\n      }\n\n      utils.log(\n        \"Debug Authentication request object\",\n        JSON.stringify(request, undefined, 2)\n      );\n\n      authurl = utils.encodeURL(authorization, request);\n\n      // We'd like to cache the hash for not loosing Application state.\n      // With the implciit grant flow, the hash will be replaced with the access\n      // token when we return after authorization.\n      if (window.location.hash) {\n        request.restoreHash = window.location.hash;\n      }\n      request.providerID = this.providerID;\n      if (scopes) {\n        request.scopes = scopes;\n      }\n\n      utils.log(\"Saving state [\" + request.state + \"]\");\n      utils.log(JSON.parse(JSON.stringify(request)));\n\n      var loader = this.Loader;\n      if (opts.hasOwnProperty(\"loader\")) {\n        loader = opts.loader;\n      }\n\n      utils.log(\"Looking for loader\", opts, loader);\n\n      this.store.saveState(request.state, request);\n      return this.gotoAuthorizeURL(authurl, loader).then(response => {\n        if (response !== true) {\n          return this.callback(response);\n        }\n      });\n    });\n  }\n\n  gotoAuthorizeURL(url, Loader) {\n    return new Promise(function(resolve, reject) {\n      if (Loader !== null && typeof Loader === \"function\") {\n        var loader = new Loader(url);\n        if (!(loader instanceof BasicLoader)) {\n          throw new Error(\n            \"JSO selected Loader is not an instance of BasicLoader.\"\n          );\n        }\n        resolve(loader.execute());\n      } else {\n        reject(\n          new Error(\n            \"Cannot redirect to authorization endpoint because of missing redirect handler\"\n          )\n        );\n      }\n    });\n  }\n\n  wipeTokens() {\n    this.store.wipeTokens(this.providerID);\n  }\n}\n\n// Object.assign(JSO.prototype, new EventEmitter({}))\n\nexport {\n  JSO,\n  BasicLoader,\n  HTTPRedirect,\n  Popup,\n  IFramePassive,\n  Fetcher,\n  FetcherJQuery\n};\n// Work in progress\n// Authentication\n"],"sourceRoot":""}